<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mot de Passe Oubli√© - BeauxB√¢tons RPG</title>
    <link rel="stylesheet" href="css/styles.css">
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            document.getElementById("reset-form").addEventListener("submit", function (event) {
                event.preventDefault();

                const pseudo = document.getElementById("pseudo").value.trim();
                const newPassword = document.getElementById("new-password").value.trim();
                const confirmPassword = document.getElementById("confirm-password").value.trim();

                if (newPassword !== confirmPassword) {
                    alert("‚ùå Les mots de passe ne correspondent pas !");
                    return;
                }

                let membres = JSON.parse(localStorage.getItem("membres")) || [];
                let membreIndex = membres.findIndex(m => m.pseudo === pseudo);

                if (membreIndex === -1) {
                    alert("‚ùå Aucun compte trouv√© avec ce pseudo !");
                    return;
                }

                // Mise √† jour du mot de passe
                membres[membreIndex].password = newPassword;
                localStorage.setItem("membres", JSON.stringify(membres));

                // Enregistrement de la date et l'heure de modification
                const currentDate = new Date();
                const formattedDate = currentDate.toLocaleDateString() + " √† " + currentDate.toLocaleTimeString();
                
                let notifications = JSON.parse(localStorage.getItem("notifications")) || [];
                notifications.push({
                    pseudo: pseudo,
                    message: `Votre mot de passe a √©t√© modifi√© le ${formattedDate}.`
                });
                localStorage.setItem("notifications", JSON.stringify(notifications));

                alert(`‚úÖ Mot de passe mis √† jour avec succ√®s !\nDate : ${formattedDate}`);
                window.location.href = "connexion.html";
            });
        });
    </script>
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <ul>
                <li><a href="index.html">üè† Accueil</a></li>
                <li><a href="inscription.html">üìù Inscription</a></li>
                <li><a href="connexion.html">üîë Connexion</a></li>
                <li><a href="contextRP.html">üìñ Contexte RP</a></li>
                <li><a href="comment-rp.html">üé≠ Comment RP ?</a></li>
                <li><a href="discord.html">üí¨ Serveur Discord</a></li>
            </ul>
        </aside>

        <div class="form-box">
            <h1>üîí Mot de Passe Oubli√©</h1>
            <p>Entrez votre pseudo et un nouveau mot de passe pour r√©initialiser votre acc√®s.</p>
            
            <form id="reset-form">
                <label for="pseudo">Pseudo :</label>
                <input type="text" id="pseudo" required>

                <label for="new-password">Nouveau Mot de Passe :</label>
                <input type="password" id="new-password" required>

                <label for="confirm-password">Confirmez le Mot de Passe :</label>
                <input type="password" id="confirm-password" required>

                <button type="submit" class="btn">R√©initialiser le Mot de Passe</button>
            </form>

            <p><a href="connexion.html">Retour √† la connexion</a></p>
        </div>
    </div>

    <footer class="fixed-footer">
        <p>&copy; 2025 BeauxB√¢tons RPG - Tous droits r√©serv√©s</p>
    </footer>
</body>
</html>
